create FUNCTION [dbo].[fn_CSVToTable_Clear_csv] ( @StringInput VARCHAR(max) )
RETURNS VARCHAR(max)
AS
BEGIN
	declare @OutputTable TABLE ( [String] VARCHAR(max) )
    DECLARE @String    VARCHAR(max)
    DECLARE @StringOutput    VARCHAR(max)

    WHILE LEN(@StringInput) > 0
    BEGIN
        SET @String      = LEFT(@StringInput, 
                                ISNULL(NULLIF(CHARINDEX(',', @StringInput) - 1, -1),
                                LEN(@StringInput)))
        SET @StringInput = SUBSTRING(@StringInput,
                                     ISNULL(NULLIF(CHARINDEX(',', @StringInput), 0),
                                     LEN(@StringInput)) + 1, LEN(@StringInput))

        INSERT INTO @OutputTable ( [String] )
        VALUES ( @String )
    END

delete from @OutputTable
where string not in (
 'CallingSystemID'
 ,'GroupID'
 ,'SiteID'
 ,'DomainID'
 ,'MemberID'
 ,'CustomerID'
 ,'TargetMemberID'
 ,'ToMemberID'
 ,'FromMemberID'
) 

SELECT @StringOutput = COALESCE(@StringOutput+',' ,'') + string
FROM @OutputTable

    
    
    
    RETURN (@StringOutput)
END